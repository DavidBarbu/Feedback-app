<%- include('header') -%>


    <div class="text-center center-div" id="login">
        <div class="container w-25 border py-5">
            <div class="title pb-5">
                <h2 class="font-weight-bold">Login </h2>
                <span>Log in for the existing user</span>
            </div>
            <form action="/route/login" method="POST" class="pt-3">
                <div class="form-group">
                    <input id="email" type="email" class="form-control" placeholder="email" name="email">
                    <small class="form-text text-muted text-left">Emailul trebuie sa contina @s.unibuc.ro sau
                        @unibuc.ro</small>
                </div>
                <div class="form-group">
                    <input id="password" type="password" class="form-control" name="password" placeholder="password">
                </div>
                <button id="get" class="btn btn-success rounded-pill">Submit/GET</button>
            </form>

            <script>
                console.log("a ajuns aici")
                const getBtn = document.getElementById("get");

                //console.log(userEmail)
                //console.log(userPassword.value)
                const baseUrl = 'http://localhost:3000/route/login'

                getBtn.addEventListener("click", getInfo)

                async function getInfo(e) {
                    e.preventDefault();
                    var userEmail = document.getElementById("email");
                    var userPassword = document.getElementById("password");
                    const cred = { email: userEmail.value, password: userPassword.value }
                    console.log(cred);

                    const res = await fetch(baseUrl,
                        {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(cred)
                        })
                    console.log("a ajuns aici")
                    console.log("aici e res: ", res.body)
                    res.json().then(body => console.log("token:", body));
                    //let b  = await res.json().then(body => window.sessionStorage.setItem('token', body));

                    window.sessionStorage.setItem('token', res.body);
                    //window.sessionStorage.setItem('token', token)
                    //console.log("Token:", window.sessionStorage.getItem('token'));
                }
            </script>

        </div>
    </div>


    <%- include('footer') -%>